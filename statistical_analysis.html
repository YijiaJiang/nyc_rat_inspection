<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Statistical Analysis</title>

<script src="site_libs/header-attrs-2.17/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />
<link rel="icon" type="image/png" href="pic/rat.png"/>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>






<link rel="stylesheet" href="style.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">NYC RAT INSPECTION</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="exploratory_data_analysis.html">Exploratory Data Analysis</a>
</li>
<li>
  <a href="statistical_analysis.html">Statistical Analysis</a>
</li>
<li>
  <a href="regression_analysis.html">Regression Analysis</a>
</li>
<li>
  <a href="dashboard.html">Dashboard</a>
</li>
<li>
  <a href="https://lghtnpl.shinyapps.io/rat_app/">Shiny App</a>
</li>
<li>
  <a href="report.html">Report</a>
</li>
<li>
  <a href="https://youtube.com">
    <span class="fa fa-play-circle fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/YijiaJiang/nyc_rat_inspection">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Statistical Analysis</h1>

</div>


<pre class="r"><code>knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
library(readxl)
library(patchwork)
library(plotly)
library(leaflet)
library(ggplot2)
library(lubridate)

knitr::opts_chunk$set(
  fig.width = 6,
  fig.asp = .6,
  out.width = &quot;90%&quot;)

theme_set(theme_minimal() + theme(legend.position = &quot;bottom&quot;))
options(
  ggplot2.continuous.colour = &quot;viridis&quot;,
  ggplot2.continuous.fill = &quot;viridis&quot;
)

scale_colour_discrete = scale_colour_viridis_d
scale_fill_discrete = scale_fill_viridis_d</code></pre>
<pre class="r"><code>url_2012 = &quot;https://raw.githubusercontent.com/YijiaJiang/p8105_final_project_data/main/rat_2012.csv&quot;
rat_2012 = read_csv(url(url_2012)) 
url_2013 = &quot;https://raw.githubusercontent.com/YijiaJiang/p8105_final_project_data/main/rat_2013.csv&quot;
rat_2013 = read_csv(url(url_2013)) 
url_2014 = &quot;https://raw.githubusercontent.com/YijiaJiang/p8105_final_project_data/main/rat_2014.csv&quot;
rat_2014 = read_csv(url(url_2014)) 
url_2015 = &quot;https://raw.githubusercontent.com/YijiaJiang/p8105_final_project_data/main/rat_2015.csv&quot;
rat_2015 = read_csv(url(url_2015)) 
url_2016 = &quot;https://raw.githubusercontent.com/YijiaJiang/p8105_final_project_data/main/rat_2016.csv&quot;
rat_2016 = read_csv(url(url_2016)) 
url_2017 = &quot;https://raw.githubusercontent.com/YijiaJiang/p8105_final_project_data/main/rat_2017.csv&quot;
rat_2017 = read_csv(url(url_2017)) 
url_2018 = &quot;https://raw.githubusercontent.com/YijiaJiang/p8105_final_project_data/main/rat_2018.csv&quot;
rat_2018 = read_csv(url(url_2018)) 
url_2019 = &quot;https://raw.githubusercontent.com/YijiaJiang/p8105_final_project_data/main/rat_2019.csv&quot;
rat_2019 = read_csv(url(url_2019)) 
url_2020 = &quot;https://raw.githubusercontent.com/YijiaJiang/p8105_final_project_data/main/rat_2020.csv&quot;
rat_2020 = read_csv(url(url_2020)) 
url_2021 = &quot;https://raw.githubusercontent.com/YijiaJiang/p8105_final_project_data/main/rat_2021.csv&quot;
rat_2021 = read_csv(url(url_2021)) 
rat = bind_rows(rat_2012, rat_2013, rat_2014, rat_2015, rat_2016, rat_2017, rat_2018, rat_2019, rat_2020, rat_2021) %&gt;%
  select(-...1) %&gt;%
   mutate(inspection_month_n = recode(inspection_month, 
                                   &quot;Jan&quot; = 1,
                                   &quot;Feb&quot; = 2,
                                   &quot;Mar&quot; = 3,
                                   &quot;Apr&quot; = 4,
                                   &quot;May&quot; = 5,
                                   &quot;Jun&quot; = 6,
                                   &quot;Jul&quot; = 7,
                                   &quot;Aug&quot; = 8,
                                   &quot;Sep&quot; = 9,
                                   &quot;Oct&quot; = 10,
                                   &quot;Nov&quot; = 11,
                                   &quot;Dec&quot; = 12)) %&gt;%
  mutate(date = paste(inspection_year, inspection_month_n, inspection_day, sep = &quot;-&quot;))%&gt;%
  mutate(date = as.Date(date,format = &quot;%Y-%m-%d&quot;))</code></pre>
<div id="over-time" class="section level2">
<h2>Over time</h2>
<div id="chi-square-testing-homogenity" class="section level3">
<h3>Chi-square testing homogenity</h3>
<p> </p>
</div>
</div>
<div id="boroughs" class="section level2">
<h2>Boroughs</h2>
<p> </p>
<div id="chi-square-testing-homogenity-among-boroughs-in-recent-years"
class="section level3">
<h3>Chi-square testing homogenity among boroughs in recent years</h3>
<p>We decide to look at the nearest three years to figure out the
distribution of inspections varies in different boroughs from year to
year</p>
<p><span class="math inline">\(H_0\)</span> : The distribution of
inspections among boroughs are same across the three years.</p>
<p><span class="math inline">\(H_1\)</span> : The distribution of
inspections among boroughs aren’t all the same across the three
years.</p>
<pre class="r"><code># create a data frame
rat_years = rbind(rat_2019, rat_2020, rat_2021) %&gt;% 
  janitor::clean_names() %&gt;% 
  dplyr::select(inspection_year, borough) %&gt;% 
  group_by(borough, inspection_year) %&gt;%
  summarize(frequency = n()) %&gt;%
  mutate(borough = as.factor(borough),
    borough = fct_reorder(borough, frequency, .desc = TRUE)) %&gt;% 
  pivot_wider(names_from = &quot;inspection_year&quot;, values_from = &quot;frequency&quot;)</code></pre>
<pre><code>## `summarise()` has grouped output by &#39;borough&#39;. You can override
## using the `.groups` argument.</code></pre>
<pre class="r"><code>#print the table
rat_years %&gt;% t() %&gt;% 
knitr::kable(caption = &quot;Distribution of inspections across the years&quot;)</code></pre>
<table>
<caption>Distribution of inspections across the years</caption>
<tbody>
<tr class="odd">
<td align="left">borough</td>
<td align="left">Bronx</td>
<td align="left">Brooklyn</td>
<td align="left">Manhattan</td>
<td align="left">Queens</td>
<td align="left">Staten Island</td>
</tr>
<tr class="even">
<td align="left">2019</td>
<td align="left">64669</td>
<td align="left">85285</td>
<td align="left">77958</td>
<td align="left">15070</td>
<td align="left">4269</td>
</tr>
<tr class="odd">
<td align="left">2020</td>
<td align="left">17477</td>
<td align="left">29401</td>
<td align="left">19356</td>
<td align="left">3947</td>
<td align="left">1589</td>
</tr>
<tr class="even">
<td align="left">2021</td>
<td align="left">26116</td>
<td align="left">38256</td>
<td align="left">32044</td>
<td align="left">6733</td>
<td align="left">2480</td>
</tr>
</tbody>
</table>
<pre class="r"><code>#Chi-square test
chisq.test(rat_years[,-1]) %&gt;% 
   broom::tidy()</code></pre>
<pre><code>## # A tibble: 1 × 4
##   statistic   p.value parameter method                    
##       &lt;dbl&gt;     &lt;dbl&gt;     &lt;int&gt; &lt;chr&gt;                     
## 1     1361. 1.78e-288         8 Pearson&#39;s Chi-squared test</code></pre>
<p>We can see from the Chi-square test above, we reject the null
hypothesis at 99% significant level. This means that the inspections
among boroughs have a different distribution across the recent three
years.</p>
<p> </p>
</div>
<div id="chi-square-testing-homogenity-among-boroughs-in-2021"
class="section level3">
<h3>Chi-square testing homogenity among boroughs in 2021</h3>
<p>Given that the distribution of inspections varies in different
boroughs from year to year, we decide to look at inspections among
different boroughs in 2021.</p>
<p><span class="math inline">\(H_0\)</span> : The distribution of
inspections among boroughs are same in 2021.</p>
<p><span class="math inline">\(H_1\)</span> : The distribution of
inspections among boroughs aren’t all the same in 2021.</p>
<pre class="r"><code># import the data
rat_boro = rat_2021 %&gt;% 
  janitor::clean_names() %&gt;% 
  dplyr::select(inspection_year, borough) %&gt;% 
  group_by(borough, inspection_year) %&gt;% 
  summarize(frequency = n()) %&gt;%
  mutate(borough = as.factor(borough),
    borough = fct_reorder(borough, frequency, .desc = TRUE)) %&gt;% 
  dplyr::select(borough, frequency)</code></pre>
<pre><code>## `summarise()` has grouped output by &#39;borough&#39;. You can override
## using the `.groups` argument.</code></pre>
<pre class="r"><code># print the table
knitr::kable(rat_boro, caption = &quot;Distribution of inspections in 2021&quot;)</code></pre>
<table>
<caption>Distribution of inspections in 2021</caption>
<thead>
<tr class="header">
<th align="left">borough</th>
<th align="right">frequency</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Bronx</td>
<td align="right">26116</td>
</tr>
<tr class="even">
<td align="left">Brooklyn</td>
<td align="right">38256</td>
</tr>
<tr class="odd">
<td align="left">Manhattan</td>
<td align="right">32044</td>
</tr>
<tr class="even">
<td align="left">Queens</td>
<td align="right">6733</td>
</tr>
<tr class="odd">
<td align="left">Staten Island</td>
<td align="right">2480</td>
</tr>
</tbody>
</table>
<pre class="r"><code># chi-square test
chisq.test(rat_boro[,-1]) %&gt;% 
  broom::tidy()</code></pre>
<pre><code>## # A tibble: 1 × 4
##   statistic p.value parameter method                                  
##       &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;                                   
## 1    46974.       0         4 Chi-squared test for given probabilities</code></pre>
<p>We can see from the chi-square test result we should reject the null
hypothesis, the inspections are not equally distributed among boroughs
in 2021.</p>
<p> </p>
</div>
</div>
<div id="weather-and-covid-19" class="section level2">
<h2>Weather and covid-19</h2>
<p> </p>
<div
id="wilcoxon-rank-sum-testing-changes-of-inspection-density-caused-by-covid-19"
class="section level3">
<h3>Wilcoxon Rank-sum testing changes of inspection density caused by
covid-19</h3>
<p>Firstly, for the rodent inspection across time, we compared mean
difference between inspection density in 2019 before covid and
inspection density in 2020 after covid.</p>
<p><span class="math inline">\(H_0\)</span> : The distribution of annual
inspection before covid and after covid is same.</p>
<p><span class="math inline">\(H_1\)</span> : The distribution of annual
inspection before covid and after covid is different.</p>
<pre class="r"><code># import the data
rat_covid = rbind(rat_2019, rat_2020) %&gt;% 
  janitor::clean_names() %&gt;% 
  dplyr::select(inspection_year, inspection_month) %&gt;% 
  mutate(Inspection_year = as.factor(inspection_year),
         Inspection_month = as.factor(inspection_month)) %&gt;%
  mutate(Inspection_month = inspection_month %&gt;% 
                       fct_relevel(&quot;Jan&quot;, &quot;Feb&quot;, &quot;Mar&quot;,&quot;Apr&quot;,&quot;May&quot;, &quot;Jun&quot;, &quot;Jul&quot;, &quot;Aug&quot;, &quot;Sep&quot;, &quot;Oct&quot;, &quot;Nov&quot;, &quot;Dec&quot;)) %&gt;%
  group_by(Inspection_year,Inspection_month) %&gt;%
  summarize(Frequency = n())</code></pre>
<pre><code>## `summarise()` has grouped output by &#39;Inspection_year&#39;. You can
## override using the `.groups` argument.</code></pre>
<pre class="r"><code># print the table
rat_covid2 = rat_covid %&gt;%   
  pivot_wider(names_from = &quot;Inspection_year&quot;, values_from = &quot;Frequency&quot;)
knitr::kable(rat_covid2, caption = &quot;Number of rat inspections before and after covid&quot;)</code></pre>
<table>
<caption>Number of rat inspections before and after covid</caption>
<thead>
<tr class="header">
<th align="left">Inspection_month</th>
<th align="right">2019</th>
<th align="right">2020</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Jan</td>
<td align="right">21833</td>
<td align="right">6589</td>
</tr>
<tr class="even">
<td align="left">Feb</td>
<td align="right">20477</td>
<td align="right">15398</td>
</tr>
<tr class="odd">
<td align="left">Mar</td>
<td align="right">24150</td>
<td align="right">10340</td>
</tr>
<tr class="even">
<td align="left">Apr</td>
<td align="right">25887</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="left">May</td>
<td align="right">20150</td>
<td align="right">2217</td>
</tr>
<tr class="even">
<td align="left">Jun</td>
<td align="right">21006</td>
<td align="right">5180</td>
</tr>
<tr class="odd">
<td align="left">Jul</td>
<td align="right">16577</td>
<td align="right">6371</td>
</tr>
<tr class="even">
<td align="left">Aug</td>
<td align="right">19201</td>
<td align="right">6628</td>
</tr>
<tr class="odd">
<td align="left">Sep</td>
<td align="right">19474</td>
<td align="right">7827</td>
</tr>
<tr class="even">
<td align="left">Oct</td>
<td align="right">17654</td>
<td align="right">2896</td>
</tr>
<tr class="odd">
<td align="left">Nov</td>
<td align="right">18360</td>
<td align="right">3585</td>
</tr>
<tr class="even">
<td align="left">Dec</td>
<td align="right">22482</td>
<td align="right">4736</td>
</tr>
</tbody>
</table>
<pre class="r"><code># Wilcoxon Rank-sum testing
wilcox.test(Frequency ~ Inspection_year, data = rat_covid,
                   exact = FALSE)</code></pre>
<pre><code>## 
##  Wilcoxon rank sum test with continuity correction
## 
## data:  Frequency by Inspection_year
## W = 144, p-value = 3.658e-05
## alternative hypothesis: true location shift is not equal to 0</code></pre>
<p>We can see from the Wilcoxon Rank-sum test result that the true
location shift is not equal to 0, which means that the medians of two
populations differ. Therefore, we have the evidence to reject the null
hypothesis and conclude that there is a difference between inspection
density in 2019 before covid and inspection density in 2020 after
covid.</p>
<p> </p>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4,h5",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
